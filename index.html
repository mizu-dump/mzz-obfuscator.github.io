<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MZ Obfuscator</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=JetBrains+Mono&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:#0c0f14;
  color:#fff;
  font-family:Orbitron,sans-serif;
}
#drawerBtn{
  position:fixed;
  top:14px;left:14px;
  width:42px;height:42px;
  border-radius:12px;
  background:linear-gradient(135deg,#5f6368,#b0b3b8,#4a4d52);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;z-index:1001;
}
#drawer{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;z-index:1000}
#drawer.open{display:block}
#drawerPanel{
  width:260px;height:100%;
  background:#0f131b;padding:20px;
  animation:slide .25s ease forwards;
}
@keyframes slide{from{transform:translateX(-100%)}to{transform:none}}

.container{max-width:900px;margin:auto;padding:20px;text-align:center}
.box{background:#11151d;padding:20px;border-radius:14px;margin-top:20px}
button,input{width:100%;padding:14px;border-radius:12px;border:none}
button{cursor:pointer;background:linear-gradient(135deg,#5f6368,#b0b3b8,#4a4d52)}
textarea{display:none;margin-top:20px;height:280px;background:#0f131b;color:#cfd2d6;border-radius:12px;padding:15px;font-family:JetBrains Mono}
.actions{display:none;gap:10px;margin-top:10px}
label{display:flex;gap:10px;align-items:center;margin-top:10px;font-size:.85em}
.progress{height:10px;background:#222;border-radius:20px;overflow:hidden;margin-top:10px}
.bar{height:100%;width:0%;background:linear-gradient(135deg,#5f6368,#b0b3b8,#4a4d52)}
footer{opacity:.5;font-size:.8em;text-align:center;margin:15px}
</style>
</head>

<body>

<div id="drawerBtn">☰</div>

<div id="drawer">
  <div id="drawerPanel">
    <h3>MZ Obfuscator</h3>
    <p style="font-size:.8em;opacity:.6;line-height:1.6">
      • VM Execution<br>
      • Anti-Tamper Loader<br>
      • Constant Encryption<br>
      • Control-Flow Flattening
    </p>
    <div style="display:flex;gap:16px;margin-top:20px">
      <a href="https://discord.gg/mzzhub" target="_blank"><i class="fa-brands fa-discord fa-xl"></i></a>
      <a href="https://github.com/mzzhub" target="_blank"><i class="fa-brands fa-github fa-xl"></i></a>
    </div>
  </div>
</div>

<div class="container">
<h1>MZ Obfuscator</h1>

<div class="box">
<input type="file" id="fileInput" accept=".lua,.txt">

<label><input type="checkbox" id="anti"> Anti-Tamper (loader protection)</label>
<label><input type="checkbox" id="max"> Max Security (VM hardening)</label>
<label><input type="checkbox" id="constp"> Constant Protection</label>

<button onclick="start()">Obfuscate</button>

<div id="status"></div>
<div class="progress"><div class="bar" id="bar"></div></div>

<textarea id="output" readonly></textarea>

<div class="actions" id="actions">
<button onclick="copyText()">COPY</button>
<button onclick="download()">DOWNLOAD</button>
</div>
</div>
</div>

<footer>© MZZ COMMUNITY</footer>

<script>
/* Drawer */
drawerBtn.onclick=()=>{drawer.classList.add("open");drawerBtn.style.display="none";}
drawer.onclick=e=>{if(e.target===drawer){drawer.classList.remove("open");drawerBtn.style.display="flex";}}

/* Obfuscator */
function start(){
  const f=fileInput.files[0];
  if(!f)return alert("Select a file");
  const r=new FileReader();
  r.onload=()=>process(r.result);
  r.readAsText(f);
}

function process(code){
  let p=0;
  output.style.display="none";
  actions.style.display="none";
  const t=setInterval(()=>{
    p+=15;
    bar.style.width=Math.min(p,100)+"%";
    status.textContent="Obfuscating"+(".".repeat((p/15)%4));
    if(p>=100){
      clearInterval(t);
      output.value=obfuscate(code);
      output.style.display="block";
      actions.style.display="flex";
      status.textContent="Completed";
    }
  },180);
}

function obfuscate(src){
  const anti=anti.checked, maxs=max.checked, cst=constp.checked;
  let key=Math.floor(Math.random()*200)+40;
  let data=[...src].map(c=>c.charCodeAt(0)^key);

  let loader=`local L=loadstring or load
if not L then return end
`;

  if(anti){
    loader+=`
local H=0
for i=1,#A do H=(H+A[i]*i)%999999937 end
if H~=${data.length*key%999999937} then return end
`;
  }

  let vm=`
local A={${data.join(",")}}
local K=${key}
local S=""
for i=1,#A do S=S..string.char(bit32.bxor(A[i],K)) end
`;

  if(cst){
    vm=`local C=${key}*7\n`+vm;
  }

  return `--[[ Protected by MZ Obfuscator ]]
${loader}
${vm}
(L or load)(S)()`;
}

function copyText(){navigator.clipboard.writeText(output.value)}
function download(){
  const b=new Blob([output.value]);
  const a=document.createElement("a");
  a.href=URL.createObjectURL(b);
  a.download="obfuscated.lua";
  a.click();
}
</script>

</body>
</html>
